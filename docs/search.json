[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Harshini Karthikeyan",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\nMy name is Harshini Karthikeyan, this website is a collection of my work"
  },
  {
    "objectID": "posts.html",
    "href": "posts.html",
    "title": "Posts",
    "section": "",
    "text": "Dashboard\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisualizations\n\n\n\n\n\n\nHarshini Karthikeyan\n\n\nInvalid Date\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2025-05-05-midterm-reflection/index.html",
    "href": "posts/2025-05-05-midterm-reflection/index.html",
    "title": "Dashboard",
    "section": "",
    "text": "test working in progress"
  },
  {
    "objectID": "posts/2025-05-01-Quarto Dashboards (Dynamic)/index.html",
    "href": "posts/2025-05-01-Quarto Dashboards (Dynamic)/index.html",
    "title": "Dynamic Quarto Dashboards",
    "section": "",
    "text": "test 2"
  },
  {
    "objectID": "posts/2025-05-01-Visualizations/visualizations.html",
    "href": "posts/2025-05-01-Visualizations/visualizations.html",
    "title": "Visualizations",
    "section": "",
    "text": "library(tidyverse)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(readxl)\nlibrary(ggrepel)\nlibrary(scales)\nlibrary(leaflet)\n\nlibrary(rnaturalearth)\nlibrary(sf)\nlibrary(rnaturalearthdata)\n\n\n\n\nWhile there are certainly issues with this image, do your best to tell the story of this graph in words. That is, what is this graph telling you? What do you think the authors meant to convey with it?\n\nI believe this plot is trying to show us the proportion of people in a particular country that believe a vaccine is safe. It shows us one observation per country where the y-axis appears to be country? It also sorted the observations by proportion, so that it appears that the proportions increase as the y-axis goes up.\n\nList the variables that appear to be displayed in this visualization. Hint: Variables refer to columns in the data.\n\nThe country, the global region of the country and the percentage of people in the country that believe a vaccine is safe.\n\nNow that you’re versed in the grammar of graphics (e.g., ggplot), list the aesthetics used and which variables are mapped to each.\n\nThe x-axis the percentage of people in the country that believe a vaccine is safe. The y-axis is the country, the color is filled by global region.\n\nWhat type of graph would you call this? Meaning, what geom would you use to produce this plot?\n\nI would call this a scatter plot and would use geom point to produce it.\n\nProvide at least four problems or changes that would improve this graph. Please format your changes as bullet points!\n\n\nI think this is a graph that is faceted by region of the world, but it lends to a strange stacked graph like view that is not very intuitive, and leaves some plots stranded from their axes. I would try faceting differently or trying to remove the facet entirely.\nI think having the y-axis be the countries is a bit strange, and that sorting it by the proportion feels odd, as though it is increasing over time or something, I would try sorting it alphabetically or removing the y-axis and making it a box-plot instead.\nI think having the legend at the bottom is unnecessary as the global region is also written directly onto each facet of the plot, so I would remove one of those, preferably the legend, depending on how my plot turns out.\nI think having to state that the dark vertical lines represent region medians but also not writing the number of each on the plot itself is confusing and forces the reader to then look for th median by finding the axis\n\n\n\n\n\nImprove the visualization above by either re-creating it with the issues you identified fixed OR by creating a new visualization that you believe tells the same story better.\n\n\ndata&lt;-read_excel(\"C:\\\\Users\\\\Geetha\\\\Downloads\\\\wgm2018-dataset-crosstabs-all-countries.xlsx\")\n\n\nnational &lt;- data[c('...1', '...2', '...3', 'National results','...5')]\ncolnames(national) &lt;- c(\"Country\", \"Question\", \"Response\", \"National_Results_Col_Per\", \"National_Results_Count\")\n\nnational &lt;- national[!(national$Country %in% c(NA, 'Country')),]\n#drop title row since renamed cols alr\n\n\nnational$QNumber &lt;- str_split_i(national$Question, \" \", 1)\n\n\nasia &lt;- c('Afghanistan', 'Bangladesh', 'Cambodia', 'China', 'India', 'Indonesia', 'Japan', 'Laos', 'Malaysia', 'Mongolia', 'Myanmar', 'Nepal', 'Pakistan', 'Philippines', 'Singapore', 'South Korea', 'Sri Lanka', 'Taiwan', 'Thailand', 'Vietnam'\n)\n\nmena &lt;- c('Algeria', 'Egypt', 'Iran', 'Iraq', 'Israel', 'Jordan', 'Kuwait', 'Lebanon','Libya', 'Morocco', 'Palestine', 'Saudi Arabia', 'Tunisia', 'United Arab Emirates', 'Yemen'\n)\n\namericas &lt;- c('Argentina', 'Bolivia', 'Brazil', 'Canada', 'Chile', 'Colombia', 'Costa Rica', 'Dominican Republic', 'Ecuador', 'El Salvador', 'Guatemala', \"Haiti\", 'Honduras','Mexico', 'Nicaragua', 'Panama', 'Paraguay', 'Peru', 'United States', 'Uruguay', 'Venezuela'\n)\n\nsub_sahara &lt;- c('Benin', 'Botswana', 'Burkina Faso', 'Burundi', 'Cameroon', 'Congo, Rep.','Comoros', 'Chad','Eswatini','Ethiopia', 'Gabon', 'Ghana', 'Guinea', 'Ivory Coast', 'Kenya', 'Liberia', 'Madagascar', 'Malawi', 'Mali', 'Mauritania', 'Mauritius','Mozambique', 'Namibia', 'Niger', 'Nigeria', 'Rwanda', 'Senegal','Sierra Leone', 'South Africa', 'Tanzania', 'The Gambia', 'Togo','Uganda', 'Zambia', 'Zimbabwe'\n)\n\neurope &lt;- c('Albania', 'Austria', 'Belgium', 'Bosnia and Herzegovina', 'Bulgaria','Croatia', 'Cyprus', 'Czech Republic', 'Denmark', 'Finland', 'France','Germany', 'Greece', 'Hungary', 'Iceland', 'Ireland', 'Italy', 'Kosovo','Luxembourg', 'Macedonia', 'Malta', 'Netherlands', 'Norway', \"Poland\", 'Northern Cyprus', 'Montenegro', 'Portugal', 'Romania', 'Serbia', 'Slovakia', 'Slovenia', 'Spain', 'Sweden', 'Switzerland', 'Turkey', 'United Kingdom'\n)\n\nformer_soviet &lt;- c('Armenia', 'Azerbaijan', 'Belarus', 'Estonia', 'Georgia', 'Kazakhstan', 'Kyrgyzstan', 'Latvia', 'Lithuania', 'Moldova', 'Russia', 'Tajikistan', 'Ukraine', 'Uzbekistan', 'Turkmenistan'\n)\n\noceania &lt;- c('Australia', 'New Zealand')\n\n\nnational1 &lt;- national |&gt;\n  fill(QNumber, .direction = \"down\") |&gt;\n  #Source for .direction: https://tidyr.tidyverse.org/reference/fill.html\n  filter(QNumber == \"Q25\") |&gt;\n  filter(Response == \"Strongly agree\" | Response == \"Somewhat agree\") |&gt; group_by(Country) |&gt;\n  summarize(Agree_Percent = sum(as.numeric(National_Results_Col_Per)), .groups = \"drop\") |&gt; \n  mutate(Region = case_when(\n    \n    Country %in% asia ~ \"Asia\",\n    Country %in% mena ~ \"Middle East and North Africa\",\n    Country %in% americas ~ \"Americas\",\n    Country %in% sub_sahara ~ \"Sub-Saharan Africa\",\n    Country %in% europe ~ \"Europe\",\n\n    Country %in% former_soviet ~ \"Former Soviet Union\",\n    \n    Country %in% oceania ~ \"Oceania\",\n    \n    TRUE ~ \"Other\" #used to check, there are none that fall in this category\n  ))\n  #summarize function : https://stackoverflow.com/questions/62891736/sum-sub-groups-with-dplyr\n\n\noutliers &lt;- national1|&gt;\n  group_by(Region)|&gt;\n  mutate(\n    Q1 = quantile(Agree_Percent, 0.25),  Q3 = quantile(Agree_Percent, 0.75),\n    IQR = Q3 - Q1,\n    is_outlier = Agree_Percent &lt; (Q1 - 1.5 * IQR) | Agree_Percent &gt; (Q3 + 1.5 * IQR)\n  ) |&gt;\n  filter(is_outlier)\n\n\n#layout-ncol: 2\n#knitr::include_graphics(\"images/Capture3.jpg\")\n\n#https://stackoverflow.com/questions/77144719/how-to-embed-an-image-into-a-quarto-document-in-r\n\n\nggplot(national1, aes(x = Region,y=Agree_Percent,fill = Region))+\n  geom_boxplot(outlier.shape= NA,alpha = 0.7) +  \n  geom_point(data = outliers, aes(x =Region, y= Agree_Percent), shape =16, size =3, color = \"black\") +\n  geom_text(\n    data =outliers,\n    aes(label= Country), vjust =0.25, hjust=-0.25,  size = 4, family=\"serif\"\n  )+ scale_y_continuous(labels = percent_format(accuracy = 1)) +\n  labs(\n    title = \"The Percentage of People Who Believe Vaccines are Safe by Global Region\",\n    x= \"Region\",y= NULL,\n  ) +theme_minimal(base_family = \"serif\")+\n  \n  theme(axis.text.x = element_text(angle = 20, hjust = 0.75), axis.text = element_text(size = 10,color = \"black\"), legend.position = \"none\"\n        )"
  },
  {
    "objectID": "posts/2025-05-01-Visualizations/visualizations.html#part-1",
    "href": "posts/2025-05-01-Visualizations/visualizations.html#part-1",
    "title": "Visualizations",
    "section": "",
    "text": "While there are certainly issues with this image, do your best to tell the story of this graph in words. That is, what is this graph telling you? What do you think the authors meant to convey with it?\n\nI believe this plot is trying to show us the proportion of people in a particular country that believe a vaccine is safe. It shows us one observation per country where the y-axis appears to be country? It also sorted the observations by proportion, so that it appears that the proportions increase as the y-axis goes up.\n\nList the variables that appear to be displayed in this visualization. Hint: Variables refer to columns in the data.\n\nThe country, the global region of the country and the percentage of people in the country that believe a vaccine is safe.\n\nNow that you’re versed in the grammar of graphics (e.g., ggplot), list the aesthetics used and which variables are mapped to each.\n\nThe x-axis the percentage of people in the country that believe a vaccine is safe. The y-axis is the country, the color is filled by global region.\n\nWhat type of graph would you call this? Meaning, what geom would you use to produce this plot?\n\nI would call this a scatter plot and would use geom point to produce it.\n\nProvide at least four problems or changes that would improve this graph. Please format your changes as bullet points!\n\n\nI think this is a graph that is faceted by region of the world, but it lends to a strange stacked graph like view that is not very intuitive, and leaves some plots stranded from their axes. I would try faceting differently or trying to remove the facet entirely.\nI think having the y-axis be the countries is a bit strange, and that sorting it by the proportion feels odd, as though it is increasing over time or something, I would try sorting it alphabetically or removing the y-axis and making it a box-plot instead.\nI think having the legend at the bottom is unnecessary as the global region is also written directly onto each facet of the plot, so I would remove one of those, preferably the legend, depending on how my plot turns out.\nI think having to state that the dark vertical lines represent region medians but also not writing the number of each on the plot itself is confusing and forces the reader to then look for th median by finding the axis"
  },
  {
    "objectID": "posts/2025-05-01-Visualizations/visualizations.html#improving-the-bad-visualization",
    "href": "posts/2025-05-01-Visualizations/visualizations.html#improving-the-bad-visualization",
    "title": "Visualizations",
    "section": "",
    "text": "Improve the visualization above by either re-creating it with the issues you identified fixed OR by creating a new visualization that you believe tells the same story better.\n\n\ndata&lt;-read_excel(\"C:\\\\Users\\\\Geetha\\\\Downloads\\\\wgm2018-dataset-crosstabs-all-countries.xlsx\")\n\n\nnational &lt;- data[c('...1', '...2', '...3', 'National results','...5')]\ncolnames(national) &lt;- c(\"Country\", \"Question\", \"Response\", \"National_Results_Col_Per\", \"National_Results_Count\")\n\nnational &lt;- national[!(national$Country %in% c(NA, 'Country')),]\n#drop title row since renamed cols alr\n\n\nnational$QNumber &lt;- str_split_i(national$Question, \" \", 1)\n\n\nasia &lt;- c('Afghanistan', 'Bangladesh', 'Cambodia', 'China', 'India', 'Indonesia', 'Japan', 'Laos', 'Malaysia', 'Mongolia', 'Myanmar', 'Nepal', 'Pakistan', 'Philippines', 'Singapore', 'South Korea', 'Sri Lanka', 'Taiwan', 'Thailand', 'Vietnam'\n)\n\nmena &lt;- c('Algeria', 'Egypt', 'Iran', 'Iraq', 'Israel', 'Jordan', 'Kuwait', 'Lebanon','Libya', 'Morocco', 'Palestine', 'Saudi Arabia', 'Tunisia', 'United Arab Emirates', 'Yemen'\n)\n\namericas &lt;- c('Argentina', 'Bolivia', 'Brazil', 'Canada', 'Chile', 'Colombia', 'Costa Rica', 'Dominican Republic', 'Ecuador', 'El Salvador', 'Guatemala', \"Haiti\", 'Honduras','Mexico', 'Nicaragua', 'Panama', 'Paraguay', 'Peru', 'United States', 'Uruguay', 'Venezuela'\n)\n\nsub_sahara &lt;- c('Benin', 'Botswana', 'Burkina Faso', 'Burundi', 'Cameroon', 'Congo, Rep.','Comoros', 'Chad','Eswatini','Ethiopia', 'Gabon', 'Ghana', 'Guinea', 'Ivory Coast', 'Kenya', 'Liberia', 'Madagascar', 'Malawi', 'Mali', 'Mauritania', 'Mauritius','Mozambique', 'Namibia', 'Niger', 'Nigeria', 'Rwanda', 'Senegal','Sierra Leone', 'South Africa', 'Tanzania', 'The Gambia', 'Togo','Uganda', 'Zambia', 'Zimbabwe'\n)\n\neurope &lt;- c('Albania', 'Austria', 'Belgium', 'Bosnia and Herzegovina', 'Bulgaria','Croatia', 'Cyprus', 'Czech Republic', 'Denmark', 'Finland', 'France','Germany', 'Greece', 'Hungary', 'Iceland', 'Ireland', 'Italy', 'Kosovo','Luxembourg', 'Macedonia', 'Malta', 'Netherlands', 'Norway', \"Poland\", 'Northern Cyprus', 'Montenegro', 'Portugal', 'Romania', 'Serbia', 'Slovakia', 'Slovenia', 'Spain', 'Sweden', 'Switzerland', 'Turkey', 'United Kingdom'\n)\n\nformer_soviet &lt;- c('Armenia', 'Azerbaijan', 'Belarus', 'Estonia', 'Georgia', 'Kazakhstan', 'Kyrgyzstan', 'Latvia', 'Lithuania', 'Moldova', 'Russia', 'Tajikistan', 'Ukraine', 'Uzbekistan', 'Turkmenistan'\n)\n\noceania &lt;- c('Australia', 'New Zealand')\n\n\nnational1 &lt;- national |&gt;\n  fill(QNumber, .direction = \"down\") |&gt;\n  #Source for .direction: https://tidyr.tidyverse.org/reference/fill.html\n  filter(QNumber == \"Q25\") |&gt;\n  filter(Response == \"Strongly agree\" | Response == \"Somewhat agree\") |&gt; group_by(Country) |&gt;\n  summarize(Agree_Percent = sum(as.numeric(National_Results_Col_Per)), .groups = \"drop\") |&gt; \n  mutate(Region = case_when(\n    \n    Country %in% asia ~ \"Asia\",\n    Country %in% mena ~ \"Middle East and North Africa\",\n    Country %in% americas ~ \"Americas\",\n    Country %in% sub_sahara ~ \"Sub-Saharan Africa\",\n    Country %in% europe ~ \"Europe\",\n\n    Country %in% former_soviet ~ \"Former Soviet Union\",\n    \n    Country %in% oceania ~ \"Oceania\",\n    \n    TRUE ~ \"Other\" #used to check, there are none that fall in this category\n  ))\n  #summarize function : https://stackoverflow.com/questions/62891736/sum-sub-groups-with-dplyr\n\n\noutliers &lt;- national1|&gt;\n  group_by(Region)|&gt;\n  mutate(\n    Q1 = quantile(Agree_Percent, 0.25),  Q3 = quantile(Agree_Percent, 0.75),\n    IQR = Q3 - Q1,\n    is_outlier = Agree_Percent &lt; (Q1 - 1.5 * IQR) | Agree_Percent &gt; (Q3 + 1.5 * IQR)\n  ) |&gt;\n  filter(is_outlier)\n\n\n#layout-ncol: 2\n#knitr::include_graphics(\"images/Capture3.jpg\")\n\n#https://stackoverflow.com/questions/77144719/how-to-embed-an-image-into-a-quarto-document-in-r\n\n\nggplot(national1, aes(x = Region,y=Agree_Percent,fill = Region))+\n  geom_boxplot(outlier.shape= NA,alpha = 0.7) +  \n  geom_point(data = outliers, aes(x =Region, y= Agree_Percent), shape =16, size =3, color = \"black\") +\n  geom_text(\n    data =outliers,\n    aes(label= Country), vjust =0.25, hjust=-0.25,  size = 4, family=\"serif\"\n  )+ scale_y_continuous(labels = percent_format(accuracy = 1)) +\n  labs(\n    title = \"The Percentage of People Who Believe Vaccines are Safe by Global Region\",\n    x= \"Region\",y= NULL,\n  ) +theme_minimal(base_family = \"serif\")+\n  \n  theme(axis.text.x = element_text(angle = 20, hjust = 0.75), axis.text = element_text(size = 10,color = \"black\"), legend.position = \"none\"\n        )"
  },
  {
    "objectID": "posts/2025-05-01-Visualizations/visualizations.html#second-data-visualization-improvement",
    "href": "posts/2025-05-01-Visualizations/visualizations.html#second-data-visualization-improvement",
    "title": "Visualizations",
    "section": "Second Data Visualization Improvement",
    "text": "Second Data Visualization Improvement\n\nSelect a data visualization in the report that you think could be improved. Be sure to cite both the page number and figure title. Do your best to tell the story of this graph in words. That is, what is this graph telling you? What do you think the authors meant to convey with it?\n\nChart 5.7: Map of proportions of people reporting vaccinating their children on page 121. This graph is telling us what percentage of the people in a particular country say their children have been vaccinated. It compares between countries, highlighting where this percentage is particularly high or low.\n\n#knitr::include_graphics(\"images/Capture.jpg\")\n\n\nList the variables that appear to be displayed in this visualization.\n\nPercentage of people who answered ‘yes’ to their children having received vaccines and Country,\n\nNow that you’re versed in the grammar of graphics (ggplot), list the aesthetics used and which variables are specified for each.\n\nThe map shows the variable country, the color is filled by the percentage of people who answered ‘yes’.\n\nWhat type of graph would you call this?\n\nI would call this a chloropleth map!\nSource: https://support.esri.com/en-us/gis-dictionary/choropleth-map#:~:text=From%20the%20Greek%20terms%20choro,combining%20different%20sets%20of%20symbols.\n\nList all of the problems or things you would improve about this graph.\n\n\nI would make the color scaling more distinct and more apparent as it is difficult to visibly see the percentage or people who said their children had been vaccinated.\nI might add in global region to see if that shows any distinctions.\nI would make the countries that were not surveyed a more distinct color from the background color as it is hard to notice island nations and the like.\n\n\nImprove the visualization above by either re-creating it with the issues you identified fixed OR by creating a new visualization that you believe tells the same story better.\n\n\nnational2 &lt;- national |&gt;\n  fill(QNumber, .direction = \"down\") |&gt;\n  #Source for .direction: https://tidyr.tidyverse.org/reference/fill.html\n  filter(QNumber == \"Q28\")|&gt; filter(Response == \"Yes\") |&gt; mutate(Region = case_when(\n    \n    Country %in% asia ~ \"Asia\",\n    Country %in% mena ~ \"Middle East and North Africa\",\n    Country %in% americas ~ \"Americas\",\n     Country %in% sub_sahara ~ \"Sub-Saharan Africa\",\n    Country %in% europe ~ \"Europe\",\n    \n    Country %in% former_soviet ~ \"Former Soviet Union\",\n    \n    Country %in% oceania ~ \"Oceania\",\n    \n    TRUE ~ \"Other\" #used to check, there are none that fall in this category\n  ))\nhead(national2)\n\n# A tibble: 6 × 7\n  Country     Question    Response National_Results_Col…¹ National_Results_Count\n  &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;                  &lt;chr&gt;                 \n1 Afghanistan Q28 (If re… Yes      0.95331555488694564    632                   \n2 Albania     Q28 (If re… Yes      0.95328945962213618    615                   \n3 Algeria     Q28 (If re… Yes      0.97813253179775439    451                   \n4 Argentina   Q28 (If re… Yes      0.97761035249142625    703                   \n5 Armenia     Q28 (If re… Yes      0.89102412357204641    615                   \n6 Australia   Q28 (If re… Yes      0.95963873905667174    713                   \n# ℹ abbreviated name: ¹​National_Results_Col_Per\n# ℹ 2 more variables: QNumber &lt;chr&gt;, Region &lt;chr&gt;\n\n\n\nworld &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\")\nworld$Country &lt;- tolower(world$name_long)\nnational2$Country &lt;- tolower(national2$Country)\n\nworld_data &lt;- left_join(world, national2, by = c(\"Country\" = \"Country\"))\nworld_data$National_Results_Col_Per &lt;- as.numeric(world_data$National_Results_Col_Per)\n\n#world_data$National_Results_Col_Per[is.na(world_data$National_Results_Col_Per )] &lt;- \"Countries not surveyed\"\n\n\n#colorpalette\npal &lt;- colorBin(\n  palette =c(\"#ffffd4\", \"#fec44f\", \"#fe9929\", \"#fc4e2a\", \"#b10026\"),\n  #https://loading.io/color/feature/YlOrRd-8\n  domain = world_data$National_Results_Col_Per,\n  bins =c(0, 0.70, 0.80, 0.90, 0.95, 1.00), na.color =\"#d3d3d3\"  \n)\n\n#plot\nleaflet(world_data) |&gt; addTiles() |&gt;\n  addPolygons(\n    fillColor = ~pal(National_Results_Col_Per), weight = 1,\n    color = \"white\", fillOpacity = 0.8,\n    label = ~paste0(Country, \": \", National_Results_Col_Per, \"%\"),\n    highlight = highlightOptions(\n      weight = 2, color = \"#666\",\n      fillOpacity = 0.9, bringToFront = TRUE\n    )\n    #Source: https://r-charts.com/spatial/interactive-maps-leaflet/\n  ) |&gt;\n  \n  addLegend(\n    pal = pal, values = ~National_Results_Col_Per,\n    title = \"Percentage of people who say  &lt;br&gt; their child has been vaccinated\", position = \"bottomright\"\n    #Source line break: https://www.reddit.com/r/Rlanguage/comments/6bsji1/add_line_break_to_leaflet_pop_up/\n  )"
  },
  {
    "objectID": "posts/2025-05-01-Visualizations/visualizations.html#third-data-visualization-improvement",
    "href": "posts/2025-05-01-Visualizations/visualizations.html#third-data-visualization-improvement",
    "title": "Visualizations",
    "section": "Third Data Visualization Improvement",
    "text": "Third Data Visualization Improvement\n\nSelect a data visualization in the report that you think could be improved. Be sure to cite both the page number and figure title. Do your best to tell the story of this graph in words. That is, what is this graph telling you? What do you think the authors meant to convey with it?\n\n\n#knitr::include_graphics(\"images/Capture2.jpg\")\n\n\nList the variables that appear to be displayed in this visualization.\n\nThe percentages for all of the following columns: Men, Women, 15-29, 30-49,50+, Elementary education or less, Secondary education, Post-secondary education, Rural/small town, Big city/suburb,  as well as separate created onee like Parents and Non-Parents\n\nNow that you’re versed in the grammar of graphics (ggplot), list the aesthetics used and which variables are specified for each.\n\nThe x axis is the demographic group while the y-axis is the percentage of the group that believes vaccines are unsafe!\n\nWhat type of graph would you call this?\n\nA bar plot!\n\nList all of the problems or things you would improve about this graph.\n\nI would facet this better and change the background color as the yellow almost blends in with the lighter blue background.\n\nImprove the visualization above by either re-creating it with the issues you identified fixed OR by creating a new visualization that you believe tells the same story better.\n\n\nnational3 &lt;- data[c('...1', '...2','...3','National results','...5',\n                    'Gender','...7', '...8', '...9',\n                     'Age Cohort','...11', '...12',\n                    '...13', '...14', '...15', 'General Educational Background', \n                  '...17','...18', '...19', \n                    '...20','...21','Area Type', \n                  '...23', '...24','...25')]\n\ncolnames(national3)&lt;- c(\"Country\", \"Question\", \"Response\",\n                         \"National_Results_Col_Per\", \"National_Results_Count\",\n                         \"Men\", \"Man_num\", \"Women\", \"Woman_num\",\n                         \"15-29\", \"15_29_Num\",\"30-49\",\n                 \"30_49_Num\", \"50+\", \"Above_50_Num\",\n                         \"Elementary education or less\", \"elementary_num\",\n                         \"Secondary education\",\"secondary_num\", \n                         \"Post-secondary education\",\"college_num\", \n                         \"Rural/small town\",\"rural_num\", \n                         \"Big city/suburb\",\"suburb_num\")\n\nnational3 &lt;- national3[!(national3$Country %in% c(NA, 'Country')),]\nnational3$QNumber &lt;- str_split_i(national3$Question, \" \", 1)\n\nnational3 &lt;- national3 |&gt; \n  filter(Country == \"France\")|&gt; fill(QNumber, .direction = \"down\") |&gt;\n  filter(QNumber == \"Q25\")|&gt; filter(Response %in% c(\"Strongly disagree\",\"Somewhat disagree\")) |&gt;\n  mutate(across(c(National_Results_Col_Per, Men, Women, `15-29`, `30-49`,`50+`, \n                  `Elementary education or less`, `Secondary education`, `Post-secondary education`,\n                  `Rural/small town`, `Big city/suburb`),as.numeric)) |&gt;\n  \n  summarize(across(c(National_Results_Col_Per,Men, Women, `15-29`, `30-49`,`50+`, \n                  `Elementary education or less`, `Secondary education`, `Post-secondary education`,\n                  `Rural/small town`, `Big city/suburb`), sum, na.rm = TRUE), .groups = \"drop\")|&gt;\n  mutate(Country = \"France\")\n\nWarning: There was 1 warning in `summarize()`.\nℹ In argument: `across(...)`.\nCaused by warning:\n! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.\nSupply arguments directly to `.fns` through an anonymous function instead.\n\n  # Previously\n  across(a:b, mean, na.rm = TRUE)\n\n  # Now\n  across(a:b, \\(x) mean(x, na.rm = TRUE))\n\n\n\nnational3\n\n# A tibble: 1 × 12\n  National_Results_Col_Per   Men Women `15-29` `30-49` `50+`\n                     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;\n1                    0.333 0.328 0.338   0.373   0.335 0.316\n# ℹ 6 more variables: `Elementary education or less` &lt;dbl&gt;,\n#   `Secondary education` &lt;dbl&gt;, `Post-secondary education` &lt;dbl&gt;,\n#   `Rural/small town` &lt;dbl&gt;, `Big city/suburb` &lt;dbl&gt;, Country &lt;chr&gt;\n\n\n\ndata2&lt;-read_excel(\"C:\\\\Users\\\\Geetha\\\\Downloads\\\\wgm2018-dataset-crosstabs-all-countries.xlsx\", sheet = \"Full dataset\")\nhead(data2)\n\n# A tibble: 6 × 60\n    WP5   wgt  PROJWT FIELD_DATE          YEAR_CALENDAR    Q1    Q2    Q3    Q4\n  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dttm&gt;                      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1     1 0.653 171770. 2018-01-08 00:00:00          2018     3     2     1     2\n2     1 0.696 183053. 2018-01-08 00:00:00          2018     2     2     1     2\n3     1 0.524 137829. 2018-01-08 00:00:00          2018     2     2     1    98\n4     1 0.764 201139. 2018-01-08 00:00:00          2018     2     1     1     2\n5     1 3.33  875646. 2018-01-08 00:00:00          2018     2     1     1     2\n6     1 0.371  97672. 2018-01-08 00:00:00          2018     1     1     1     2\n# ℹ 51 more variables: Q5A &lt;dbl&gt;, Q5B &lt;dbl&gt;, Q5C &lt;dbl&gt;, Q6 &lt;dbl&gt;, Q7 &lt;dbl&gt;,\n#   Q8 &lt;dbl&gt;, Q9 &lt;dbl&gt;, Q10A &lt;dbl&gt;, Q10B &lt;dbl&gt;, Q11A &lt;dbl&gt;, Q11B &lt;dbl&gt;,\n#   Q11C &lt;dbl&gt;, Q11D &lt;dbl&gt;, Q11E &lt;dbl&gt;, Q11F &lt;dbl&gt;, Q11G &lt;dbl&gt;, Q12 &lt;dbl&gt;,\n#   Q13 &lt;dbl&gt;, Q14A &lt;dbl&gt;, Q14B &lt;dbl&gt;, Q15A &lt;dbl&gt;, Q15B &lt;dbl&gt;, Q16 &lt;dbl&gt;,\n#   Q17 &lt;dbl&gt;, Q18 &lt;dbl&gt;, Q19 &lt;dbl&gt;, Q20 &lt;dbl&gt;, Q21 &lt;dbl&gt;, Q22 &lt;dbl&gt;,\n#   Q23 &lt;dbl&gt;, Q24 &lt;dbl&gt;, Q25 &lt;dbl&gt;, Q26 &lt;dbl&gt;, Q27 &lt;dbl&gt;, Q28 &lt;dbl&gt;, D1 &lt;dbl&gt;,\n#   Q29 &lt;dbl&gt;, Q30 &lt;dbl&gt;, WGM_Index &lt;dbl&gt;, WGM_Indexr &lt;dbl&gt;, …\n\n\n\n# France's WP5 is 13\nfrance&lt;- data2|&gt; filter( WP5 == 13) |&gt; select(WP5, Q25, Q27)|&gt;group_by(Q27, Q25) |&gt;\n  summarise(count = n(), .groups = \"drop_last\") |&gt;\n  mutate(percentage = round(count / sum(count), 6)) |&gt; ungroup() |&gt;\n  filter(Q25 %in% c(4, 5)) |&gt; group_by(Q27) |&gt;\n  summarise( total_count = sum(count),\n             total_percentage = sum(percentage)) |&gt; pivot_wider(\n    names_from = Q27,\n    values_from = c(total_count, total_percentage),\n    names_glue = \"Q27_{Q27}_{.value}\") |&gt; select(Q27_1_total_percentage, Q27_2_total_percentage) |&gt;mutate(Country = \"France\")\n\n\ncolnames(france) &lt;- c(\"Parents\", \"Non-Parents\", \"Country\")\n\nfrance\n\n# A tibble: 1 × 3\n  Parents `Non-Parents` Country\n    &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;  \n1   0.314         0.299 France \n\n\n\nfrance_all&lt;- merge(national3, france, by = \"Country\")\n\nfrance_all\n\n  Country National_Results_Col_Per       Men     Women     15-29    30-49\n1  France                0.3329385 0.3277665 0.3375892 0.3727464 0.335249\n        50+ Elementary education or less Secondary education\n1 0.3158295                     0.354163           0.3378381\n  Post-secondary education Rural/small town Big city/suburb  Parents\n1                0.3017101        0.3517994       0.3073689 0.313665\n  Non-Parents\n1    0.299145\n\n\n\nfrance_long &lt;- france_all |&gt;\n  pivot_longer(\n    cols = -c(Country, National_Results_Col_Per),\n    names_to = \"Category\",\n    values_to = \"Percentage\"\n  )|&gt;mutate(Group = case_when(\n   Category %in% c(\"Men\", \"Women\") ~ \"Gender\",\n    Category %in% c(\"15-29\", \"30-49\", \"50+\") ~ \"Age\",\n     Category %in% c(\"Elementary education or less\", \"Secondary education\", \"Post-secondary education\") ~ \"Education\",\n    Category %in% c(\"Rural/small town\", \"Big city/suburb\") ~ \"Region\",\n    \n    Category %in% c(\"Parents\", \"Non-Parents\") ~ \"Parenthood\",\n    TRUE ~ \"Other\"\n  ))\nfrance_long\n\n# A tibble: 12 × 5\n   Country National_Results_Col_Per Category                    Percentage Group\n   &lt;chr&gt;                      &lt;dbl&gt; &lt;chr&gt;                            &lt;dbl&gt; &lt;chr&gt;\n 1 France                     0.333 Men                              0.328 Gend…\n 2 France                     0.333 Women                            0.338 Gend…\n 3 France                     0.333 15-29                            0.373 Age  \n 4 France                     0.333 30-49                            0.335 Age  \n 5 France                     0.333 50+                              0.316 Age  \n 6 France                     0.333 Elementary education or le…      0.354 Educ…\n 7 France                     0.333 Secondary education              0.338 Educ…\n 8 France                     0.333 Post-secondary education         0.302 Educ…\n 9 France                     0.333 Rural/small town                 0.352 Regi…\n10 France                     0.333 Big city/suburb                  0.307 Regi…\n11 France                     0.333 Parents                          0.314 Pare…\n12 France                     0.333 Non-Parents                      0.299 Pare…\n\n\nI used ggrepel!\n\nggplot(france_long, aes(x = reorder(Category, Percentage), y = Percentage, fill = Category)) + geom_bar(stat = \"identity\", width = 0.7) + coord_flip() +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  facet_wrap(~ Group, scales = \"free_y\",ncol = 1) +\n  labs(title = \"Proportion of people in France who believe vaccines \\nare unsafe by Demographic Group\",\n       x = \"\",\n       y = \"\") +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  geom_text_repel(aes(label = round(Percentage, 2)), size = 3, box.padding = 0.3)"
  }
]